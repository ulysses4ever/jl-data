# Assuming dev, net, feats, ndeps are predefined
eqparse(a,b)=(isequal(a[1],b[1]), isequal(sortcols(vcat(a[2],a[3])), sortcols(vcat(b[2],b[3]))))
gnet = copy(net, :gpu)
gnet[end].f = KUnet.logp

isdefined(:g0) || @date g0=KUparser.gparse(dev,gnet,feats,ndeps)
isdefined(:g1) || @date g1=KUparser.gparse(dev,gnet,feats,ndeps,1700)
@show eqparse(g1,g0)
isdefined(:g2) || @date g2=KUparser.gparse(dev,gnet,feats,ndeps,1700,20)
@show eqparse(g2,g0)
isdefined(:g3) || @date g3=KUparser.gparse(dev,gnet,feats,ndeps,100)
@show eqparse(g3,g0)
isdefined(:g4) || @date g4=KUparser.gparse(dev,gnet,feats,ndeps,100,20)
@show eqparse(g4,g0)
isdefined(:g100) || @date g100=KUparser.gparse(dev[1:100],gnet,feats,ndeps,100,20)

if false

isdefined(:b0) || @date b0=KUparser.bparse(dev,gnet,feats,ndeps,1)
@show eqparse(b0,g0)
isdefined(:b1) || @date b1=KUparser.bparse(dev,gnet,feats,ndeps,1,1700)
@show eqparse(b1,g0)
isdefined(:b2) || @date b2=KUparser.bparse(dev,gnet,feats,ndeps,1,1700,20)
@show eqparse(b2,g0)
isdefined(:b3) || @date b3=KUparser.bparse(dev,gnet,feats,ndeps,1,100)
@show eqparse(b3,g0)
isdefined(:b4) || @date b4=KUparser.bparse(dev,gnet,feats,ndeps,1,100,20)
@show eqparse(b4,g0)

isdefined(:b01) || @date b01=KUparser.bparse(dev[1:100],gnet,feats,ndeps,10)
@show eqparse(b01,g100)
isdefined(:b11) || @date b11=KUparser.bparse(dev[1:100],gnet,feats,ndeps,10,100)
@show eqparse(b11,b01)
isdefined(:b51) || @date b51=KUparser.bparse(dev[1:100],gnet,feats,ndeps,10,5)
@show eqparse(b51,b01)
isdefined(:b21) || @date b21=KUparser.bparse(dev[1:100],gnet,feats,ndeps,10,5,20)
@show eqparse(b21,b01)
isdefined(:b31) || @date b31=KUparser.bparse(dev[1:100],gnet,feats,ndeps,10,1)
@show eqparse(b31,b01)
isdefined(:b41) || @date b41=KUparser.bparse(dev[1:100],gnet,feats,ndeps,10,1,20)
@show eqparse(b41,b01)

isdefined(:b02) || @date b02=KUparser.bparse(dev[1:100],gnet,feats,ndeps,100)
@show eqparse(b02,g100)
@show eqparse(b02,b01)
isdefined(:b12) || @date b12=KUparser.bparse(dev[1:100],gnet,feats,ndeps,100,100)
@show eqparse(b12,b02)
isdefined(:b52) || @date b52=KUparser.bparse(dev[1:100],gnet,feats,ndeps,100,5)
@show eqparse(b52,b02)
isdefined(:b22) || @date b22=KUparser.bparse(dev[1:100],gnet,feats,ndeps,100,5,20)
@show eqparse(b22,b02)
isdefined(:b32) || @date b32=KUparser.bparse(dev[1:100],gnet,feats,ndeps,100,1)
@show eqparse(b32,b02)
isdefined(:b42) || @date b42=KUparser.bparse(dev[1:100],gnet,feats,ndeps,100,1,20)
@show eqparse(b42,b02)

end