eqparse(a,b)=(isequal(a[1],b[1]), isequal(sortcols(vcat(a[2],a[3])), sortcols(vcat(b[2],b[3]))))
gnet = copy(net, :gpu)
gnet[end].f = KUnet.logp
@everywhere gc()

isdefined(:g0) || @time g0=KUparser.gparse(dev,gnet,feats)
isdefined(:g1) || @time g1=KUparser.gparse(dev,gnet,feats,1700)
@show eqparse(g1,g0)
isdefined(:g2) || @time g2=KUparser.gparse(dev,gnet,feats,1700,20)
@show eqparse(g2,g0)
isdefined(:g3) || @time g3=KUparser.gparse(dev,gnet,feats,100)
@show eqparse(g3,g0)
isdefined(:g4) || @time g4=KUparser.gparse(dev,gnet,feats,100,20)
@show eqparse(g4,g0)
isdefined(:g100) || @time g100=KUparser.gparse(dev[1:100],gnet,feats,100,20)

isdefined(:b0) || @time b0=KUparser.bparse(dev,gnet,feats,1)
@show eqparse(b0,g0)
isdefined(:b1) || @time b1=KUparser.bparse(dev,gnet,feats,1,1700)
@show eqparse(b1,g0)
isdefined(:b2) || @time b2=KUparser.bparse(dev,gnet,feats,1,1700,20)
@show eqparse(b2,g0)
isdefined(:b3) || @time b3=KUparser.bparse(dev,gnet,feats,1,100)
@show eqparse(b3,g0)
isdefined(:b4) || @time b4=KUparser.bparse(dev,gnet,feats,1,100,20)
@show eqparse(b4,g0)

isdefined(:b01) || @time b01=KUparser.bparse(dev[1:100],gnet,feats,10)
@show eqparse(b01,g100)
isdefined(:b11) || @time b11=KUparser.bparse(dev[1:100],gnet,feats,10,100)
@show eqparse(b11,b01)
isdefined(:b51) || @time b51=KUparser.bparse(dev[1:100],gnet,feats,10,5)
@show eqparse(b51,b01)
isdefined(:b21) || @time b21=KUparser.bparse(dev[1:100],gnet,feats,10,5,20)
@show eqparse(b21,b01)
isdefined(:b31) || @time b31=KUparser.bparse(dev[1:100],gnet,feats,10,1)
@show eqparse(b31,b01)
isdefined(:b41) || @time b41=KUparser.bparse(dev[1:100],gnet,feats,10,1,20)
@show eqparse(b41,b01)

isdefined(:b02) || @time b02=KUparser.bparse(dev[1:100],gnet,feats,100)
@show eqparse(b02,g100)
@show eqparse(b02,b01)
isdefined(:b12) || @time b12=KUparser.bparse(dev[1:100],gnet,feats,100,100)
@show eqparse(b12,b02)
isdefined(:b52) || @time b52=KUparser.bparse(dev[1:100],gnet,feats,100,5)
@show eqparse(b52,b02)
isdefined(:b22) || @time b22=KUparser.bparse(dev[1:100],gnet,feats,100,5,20)
@show eqparse(b22,b02)
isdefined(:b32) || @time b32=KUparser.bparse(dev[1:100],gnet,feats,100,1)
@show eqparse(b32,b02)
isdefined(:b42) || @time b42=KUparser.bparse(dev[1:100],gnet,feats,100,1,20)
@show eqparse(b42,b02)
