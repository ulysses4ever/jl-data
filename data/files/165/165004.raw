inv2(A::Array{Float64,2}) = 1/(A[1]*A[4]-A[2]*A[3])*[A[4] -A[2];-A[3] A[1]]

inv3(A::Array{Float64,2}) = 1/det(A)*[(A[2,2]*A[3,3]-A[3,2]*A[2,3]) (A[1,3]*A[3,2]-A[3,3]*A[1,2]) (A[1,2]*A[2,3]-A[2,2]*A[1,3])
                    (A[2,3]*A[3,1]-A[3,3]*A[2,1]) (A[1,1]*A[3,3]-A[3,1]*A[1,3]) (A[1,3]*A[2,1]-A[2,3]*A[1,1])
                    (A[2,1]*A[3,2]-A[3,1]*A[2,2]) (A[1,2]*A[3,1]-A[3,2]*A[1,1]) (A[1,1]*A[2,2]-A[2,1]*A[1,2])]

function inv4(m::Array{Float64,2})
    iA = zeros(Float64,4,4)
    iA[1] = (((m[6] * m[11] * m[16] - m[6] * m[12] * m[15]) - m[10] * m[7] * m[16]) + m[10] * m[8] * m[15] + m[14] * m[7] * m[12]) - m[14] * m[8] * m[11]
    iA[5] = (((-(m[5]) * m[11] * m[16] + m[5] * m[12] * m[15] + m[9] * m[7] * m[16]) - m[9] * m[8] * m[15]) - m[13] * m[7] * m[12]) + m[13] * m[8] * m[11]
    iA[9] = (((m[5] * m[10] * m[16] - m[5] * m[12] * m[14]) - m[9] * m[6] * m[16]) + m[9] * m[8] * m[14] + m[13] * m[6] * m[12]) - m[13] * m[8] * m[10]
    iA[13] = (((-(m[5]) * m[10] * m[15] + m[5] * m[11] * m[14] + m[9] * m[6] * m[15]) - m[9] * m[7] * m[14]) - m[13] * m[6] * m[11]) + m[13] * m[7] * m[10]
    iA[2] = (((-(m[2]) * m[11] * m[16] + m[2] * m[12] * m[15] + m[10] * m[3] * m[16]) - m[10] * m[4] * m[15]) - m[14] * m[3] * m[12]) + m[14] * m[4] * m[11]
    iA[6] = (((m[1] * m[11] * m[16] - m[1] * m[12] * m[15]) - m[9] * m[3] * m[16]) + m[9] * m[4] * m[15] + m[13] * m[3] * m[12]) - m[13] * m[4] * m[11]
    iA[10] = (((-(m[1]) * m[10] * m[16] + m[1] * m[12] * m[14] + m[9] * m[2] * m[16]) - m[9] * m[4] * m[14]) - m[13] * m[2] * m[12]) + m[13] * m[4] * m[10]
    iA[14] = (((m[1] * m[10] * m[15] - m[1] * m[11] * m[14]) - m[9] * m[2] * m[15]) + m[9] * m[3] * m[14] + m[13] * m[2] * m[11]) - m[13] * m[3] * m[10]
    iA[3] = (((m[2] * m[7] * m[16] - m[2] * m[8] * m[15]) - m[6] * m[3] * m[16]) + m[6] * m[4] * m[15] + m[14] * m[3] * m[8]) - m[14] * m[4] * m[7]
    iA[7] = (((-(m[1]) * m[7] * m[16] + m[1] * m[8] * m[15] + m[5] * m[3] * m[16]) - m[5] * m[4] * m[15]) - m[13] * m[3] * m[8]) + m[13] * m[4] * m[7]
    iA[11] = (((m[1] * m[6] * m[16] - m[1] * m[8] * m[14]) - m[5] * m[2] * m[16]) + m[5] * m[4] * m[14] + m[13] * m[2] * m[8]) - m[13] * m[4] * m[6]
    iA[15] = (((-(m[1]) * m[6] * m[15] + m[1] * m[7] * m[14] + m[5] * m[2] * m[15]) - m[5] * m[3] * m[14]) - m[13] * m[2] * m[7]) + m[13] * m[3] * m[6]
    iA[4] = (((-(m[2]) * m[7] * m[12] + m[2] * m[8] * m[11] + m[6] * m[3] * m[12]) - m[6] * m[4] * m[11]) - m[10] * m[3] * m[8]) + m[10] * m[4] * m[7]
    iA[8] = (((m[1] * m[7] * m[12] - m[1] * m[8] * m[11]) - m[5] * m[3] * m[12]) + m[5] * m[4] * m[11] + m[9] * m[3] * m[8]) - m[9] * m[4] * m[7]
    iA[12] = (((-(m[1]) * m[6] * m[12] + m[1] * m[8] * m[10] + m[5] * m[2] * m[12]) - m[5] * m[4] * m[10]) - m[9] * m[2] * m[8]) + m[9] * m[4] * m[6]
    iA[16] = (((m[1] * m[6] * m[11] - m[1] * m[7] * m[10]) - m[5] * m[2] * m[11]) + m[5] * m[3] * m[10] + m[9] * m[2] * m[7]) - m[9] * m[3] * m[6]

    d = m[1] * iA[1] + m[2] * iA[5] + m[3] * iA[9] + m[4] * iA[13]
    d==0 && error("Matrix is singular")

    d = 1.0 / d
    for i = 1:16
        iA[i] *= d
    end
    return iA
end
