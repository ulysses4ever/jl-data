using BiomolecularStructures.Mafft
using Base.Test

mafft_expected = [("gi|166158130|ref|NP_001107279.1| interleukin 4 [Xenopus (Silurana) tropicalis]","MSNLGRILCAVLGLFHLLSANPVPSSKLQIAIEEIISELVNNKITHK-----KCFVPTPYDDEEEASVEEISCRAFKSLKHVCASER--------------------KNLRLLNASLITMFSE-----NVECSINNDEQKDLISVIEDLLTFFRAQM-RKLVMNPKH")  
 ("gi|55742622|ref|NP_999288.1| interleukin-4 precursor [Sus scrofa]","M-GLTSQLIPTLVCLLACTSNFVHGHKCDITLQEIIKTL--NILTARKNSCMELPVTDVFAAPENTTEKETFCRASTVLRHIYRHHT----CMK-------------SLLSGLDRNLSSMAN-------MTCSVHEAKKSTLKDFLERLKTIMKEKY-SKC------")               
 ("gi|55741696|ref|NP_001007080.1| interleukin 4 [Gallus gallus]","MSSSLPTLLALLVLLAGPGAVPTLCLQLSVPLMESIRIV--NDIQGE-VSCVKMNVTDIFADNKTNNKTELLCKASTI---VWESQH----CH--------------KNLQGLFLNMRQLLNASSTSLKAPCPTAAGNTTSMEKFLADLRTFFHQLAKNK-------")                   
 ("gi|50978886|ref|NP_001003159.1| interleukin-4 precursor [Canis lupus familiaris]","M-GLTSQLIPTLVCLLALTSTFVHGHNFNITIKEIIKML--NILTARNDSCMELTVKDVFTAPKNTSDKEIFCRAATVLRQIYTHN-----CSN-------------RYLRGLYRNLSSMAN-------KTCSMNEIKKSTLKDFLERLKVIMQKKY-YRH------")
 ("gi|42627877|ref|NP_958427.1| interleukin-4 precursor [Rattus norvegicus]","M-GLSPHLAVTLFCFLICTGNGIHGCN-DSPLREIINTL--NQVTEKGTPCTEMFVPDVLTATRNTTENELICRASRVLRKFYFPRDVPP-CLK-------NKSGVLGELRKLCRGVSGLNS------LRSCTVNESTLTTLKDFLESLKSILRGKYLQSCTSM--S")        
 ("gi|58743333|ref|NP_001008993.1| interleukin-4 isoform delta2 [Pan troglodytes]","M-GLTSQLLPPLFFLLACAGNFVHGHKCDITLQEIIKTL--NSLTEQ----------------KNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAG------LNSCPVKEANQSTLENFLERLKTIMREKY-SKCSS----")  
 ("gi|112807223|ref|NP_001036804.1| interleukin-4 precursor [Felis catus]","M-DLTSQLIPALVCLLAFTSTFVHGQNFNNTLKEIIKTL--NILTARNDSCMELTVMDVLAAPKNTSDKEIFCRATTVLRQIYTHHN----CST-------------KFLKGLDRNLSSMAN-------RTCSVNEVKKCTLKDFLERLKAIMQKKY-SKH------")          
 ("2B8U:A|PDBID|CHAIN|SEQUENCE|HOMO SAPIENS","-------------------------HKCDITLQEIIKTL--NSLTEQKTLCTELTVTDIFAASKNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAG------LNSCPVKEANQSTLENFLERLKTIMREKY-SKCSS----")]

@test mafft(Pkg.dir("BiomolecularStructures","examples/fasta","il4.fasta")) == mafft_expected

fasta_in_string = ">gi|166158130|ref|NP_001107279.1| interleukin 4 [Xenopus (Silurana) tropicalis]
MSNLGRILCAVLGLFHLLSANPVPSSKLQIAIEEIISELVNNKITHKKCFVPTPYDDEEEASVEEISCRA
FKSLKHVCASERKNLRLLNASLITMFSENVECSINNDEQKDLISVIEDLLTFFRAQMRKLVMNPKH


>gi|55742622|ref|NP_999288.1| interleukin-4 precursor [Sus scrofa]
MGLTSQLIPTLVCLLACTSNFVHGHKCDITLQEIIKTLNILTARKNSCMELPVTDVFAAPENTTEKETFC
RASTVLRHIYRHHTCMKSLLSGLDRNLSSMANMTCSVHEAKKSTLKDFLERLKTIMKEKYSKC


>gi|55741696|ref|NP_001007080.1| interleukin 4 [Gallus gallus]
MSSSLPTLLALLVLLAGPGAVPTLCLQLSVPLMESIRIVNDIQGEVSCVKMNVTDIFADNKTNNKTELLC
KASTIVWESQHCHKNLQGLFLNMRQLLNASSTSLKAPCPTAAGNTTSMEKFLADLRTFFHQLAKNK"

mafft_expected_from_string = [("gi|166158130|ref|NP_001107279.1| interleukin 4 [Xenopus (Silurana) tropicalis]","M---SNLGRILCAVLGLFHLLSANPVPSSKLQIAIEEIISEL--VNNKI-THKKCFVPTPYDDEEEASVEEISCRAFKSLKHVCASE--RKN-LRLLNASLITMFSEN-----VECSINNDEQKDLISVIEDLLTFFRAQMRKLVMNPKH")
 ("gi|55742622|ref|NP_999288.1| interleukin-4 precursor [Sus scrofa]","MGLTSQLIPTLVCLLAC----TSNFVHGHKCDITLQEIIKTLNILTARKNSCMELPVTDVFAAPENTTEKETFCRASTVLRHIYRHHTCMKSLLSGLDRNLSSMANMT-------CSVHEAKKSTLKDFLERLKTIMKEKYSK------C")             
 ("gi|55741696|ref|NP_001007080.1| interleukin 4 [Gallus gallus]","M---SSSLPTLLALLVLLAGPGAVPTLCLQLSVPLMESIRIVNDIQGEV-SCVKMNVTDIFADNKTNNKTELLCKASTI---VWESQHCHKN-LQGLFLNMRQLLNASSTSLKAPCPTAAGNTTSMEKFLADLRTFFHQLAKN------K")]

@test mafft_from_string(fasta_in_string) == mafft_expected_from_string

@test mafft_linsi(Pkg.dir("BiomolecularStructures","examples/fasta","il4.fasta")) == mafft_expected

mafft_ginsi_expected = {("gi|166158130|ref|NP_001107279.1| interleukin 4 [Xenopus (Silurana) tropicalis]","MSNLGRILCAVLGLFHLLSANPVPSSKLQIAIEEIISELVNNKITHK-----KCFVPTPYDDEEEASVEEISCRAFKSLKHVCASER--------------------KNLRLLNASLITMFSE-----NVECSINNDEQKDLISVIEDLLTFFRAQMRKLVMNPKH"),("gi|55742622|ref|NP_999288.1| interleukin-4 precursor [Sus scrofa]","MGLTSQLIPTLVCLLACTS-NFVHGHKCDITLQEIIKTL--NILTARKNSCMELPVTDVFAAPENTTEKETFCRASTVLRHIYRHHTCMK-----------------SLLSGLDRNLSSMAN-------MTCSVHEAKKSTLKDFLERLKTIMKEKYSK------C"),("gi|55741696|ref|NP_001007080.1| interleukin 4 [Gallus gallus]","MSSSLPTLLALLVLLAGPGAVPTLCLQLSVPLMESIRIV--NDIQGE-VSCVKMNVTDIFADNKTNNKTELLCKASTI---VWESQHCH------------------KNLQGLFLNMRQLLNASSTSLKAPCPTAAGNTTSMEKFLADLRTFFHQLAKN------K"),("gi|50978886|ref|NP_001003159.1| interleukin-4 precursor [Canis lupus familiaris]","MGLTSQLIPTLVCLLALTS-TFVHGHNFNITIKEIIKML--NILTARNDSCMELTVKDVFTAPKNTSDKEIFCRAATVLRQIYT-HNCSN-----------------RYLRGLYRNLSSMAN-------KTCSMNEIKKSTLKDFLERLKVIMQKKYYR------H"),("gi|42627877|ref|NP_958427.1| interleukin-4 precursor [Rattus norvegicus]","MGLSPHLAVTLFCFLICTG-NGIHGCN-DSPLREIINTL--NQVTEKGTPCTEMFVPDVLTATRNTTENELICRASRVLRKFYFPRD--------VPPCLKNKSGVLGELRKLCRGVSGLNS------LRSCTVNESTLTTLKDFLESLKSILRGKYLQ-SCTSMS"),("gi|58743333|ref|NP_001008993.1| interleukin-4 isoform delta2 [Pan troglodytes]","MGLTSQLLPPLFFLLACAG-NFVHGHKCDITLQEIIKTL--NSLTEQ----------------KNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAG------LNSCPVKEANQSTLENFLERLKTIMREKYSK--CS--S"),("gi|112807223|ref|NP_001036804.1| interleukin-4 precursor [Felis catus]","MDLTSQLIPALVCLLAFTS-TFVHGQNFNNTLKEIIKTL--NILTARNDSCMELTVMDVLAAPKNTSDKEIFCRATTVLRQIYTHHNCST-----------------KFLKGLDRNLSSMAN-------RTCSVNEVKKCTLKDFLERLKAIMQKKYSK------H"),("2B8U:A|PDBID|CHAIN|SEQUENCE|HOMO SAPIENS","-------------------------HKCDITLQEIIKTL--NSLTEQKTLCTELTVTDIFAASKNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAG------LNSCPVKEANQSTLENFLERLKTIMREKYSK--CS--S")}

@test mafft_ginsi(Pkg.dir("BiomolecularStructures","examples/fasta","il4.fasta")) == mafft_ginsi_expected
@test mafft_einsi(Pkg.dir("BiomolecularStructures","examples/fasta","il4.fasta")) == mafft_expected

mafft_fftnsi_expected = {("gi|166158130|ref|NP_001107279.1| interleukin 4 [Xenopus (Silurana) tropicalis]","MSNLGRILCAVLGLFHLLSANPVPSSKLQIAIEEIISELVNNKITHK-----KCFVPTPYDDEEEASVEEISCRAFKSLKHV---------CASER-----------KNLRLLNASLITMFSEN-----VECSINNDEQKDLISVIEDLLTFFRAQMRKLVMNPKH"),("gi|55742622|ref|NP_999288.1| interleukin-4 precursor [Sus scrofa]","MG-LTSQLIPTLVCLLACTSNFVHGHKCDITLQEIIKTL--NILTARKNSCMELPVTDVFAAPENTTEKETFCRASTVLRHIYRHHT----CMK-------------SLLSGLDRNLSSMANM-------TCSVHEAKKSTLKDFLERLKTIMKEKYSKC------"),("gi|55741696|ref|NP_001007080.1| interleukin 4 [Gallus gallus]","MSSSLPTLLALLVLLAGPGAVPTLCLQLSVPLMESIRIV--NDIQGE-VSCVKMNVTDIFADNKTNNKTELLCKASTIVWESQH-------CH--------------KNLQGLFLNMRQLLNASSTSLKAPCPTAAGNTTSMEKFLADLRTFFHQLAKNK------"),("gi|50978886|ref|NP_001003159.1| interleukin-4 precursor [Canis lupus familiaris]","MG-LTSQLIPTLVCLLALTSTFVHGHNFNITIKEIIKML--NILTARNDSCMELTVKDVFTAPKNTSDKEIFCRAATVLRQIYTHN-----CSN-------------RYLRGLYRNLSSMANK-------TCSMNEIKKSTLKDFLERLKVIMQKKYYRH------"),("gi|42627877|ref|NP_958427.1| interleukin-4 precursor [Rattus norvegicus]","MG-LSPHLAVTLFCFLICTGNGIHGCN-DSPLREIINTL--NQVTEKGTPCTEMFVPDVLTATRNTTENELICRASRVLRKFYFPRDVPP-CLKNKSGVL-------GELRKLCRGVSGLNSLR------SCTVNESTLTTLKDFLESLKSILRGKYLQSCTSMS-"),("gi|58743333|ref|NP_001008993.1| interleukin-4 isoform delta2 [Pan troglodytes]","MG-LTSQLLPPLFFLLACAGNFVHGHKCDITLQEIIKTL--NSLTEQ----------------KNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAGLN------SCPVKEANQSTLENFLERLKTIMREKYSKCSS----"),("gi|112807223|ref|NP_001036804.1| interleukin-4 precursor [Felis catus]","MD-LTSQLIPALVCLLAFTSTFVHGQNFNNTLKEIIKTL--NILTARNDSCMELTVMDVLAAPKNTSDKEIFCRATTVLRQIYTHHN----CST-------------KFLKGLDRNLSSMANR-------TCSVNEVKKCTLKDFLERLKAIMQKKYSKH------"),("2B8U:A|PDBID|CHAIN|SEQUENCE|HOMO SAPIENS","-------------------------HKCDITLQEIIKTL--NSLTEQKTLCTELTVTDIFAASKNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAGLN------SCPVKEANQSTLENFLERLKTIMREKYSKCSS----")}

@test mafft_fftnsi(Pkg.dir("BiomolecularStructures","examples/fasta","il4.fasta")) == mafft_fftnsi_expected

mafft_nwnsi_expected = {("gi|166158130|ref|NP_001107279.1| interleukin 4 [Xenopus (Silurana) tropicalis]","MSNLGRILCAVLGLFHLLSANPVPSSKLQIAIEEIISELVNNKITHK-----KCFVPTPYDDEEEASVEEISCRAFKSLKHV---------CASER-----------KNLRLLNASLITMFSEN-----VECSINNDEQKDLISVIEDLLTFFRAQMRKLVMNPKH"),("gi|55742622|ref|NP_999288.1| interleukin-4 precursor [Sus scrofa]","MG-LTSQLIPTLVCLLACTSNFVHGHKCDITLQEIIKTL--NILTARKNSCMELPVTDVFAAPENTTEKETFCRASTVLRHIYRHHT----CMK-------------SLLSGLDRNLSSMANM-------TCSVHEAKKSTLKDFLERLKTIMKEKYSKC------"),("gi|55741696|ref|NP_001007080.1| interleukin 4 [Gallus gallus]","MSSSLPTLLALLVLLAGPGAVPTLCLQLSVPLMESIRIV--NDIQGE-VSCVKMNVTDIFADNKTNNKTELLCKASTIVWESQH-------CH--------------KNLQGLFLNMRQLLNASSTSLKAPCPTAAGNTTSMEKFLADLRTFFHQLAKNK------"),("gi|50978886|ref|NP_001003159.1| interleukin-4 precursor [Canis lupus familiaris]","MG-LTSQLIPTLVCLLALTSTFVHGHNFNITIKEIIKML--NILTARNDSCMELTVKDVFTAPKNTSDKEIFCRAATVLRQIYTHN-----CSN-------------RYLRGLYRNLSSMANK-------TCSMNEIKKSTLKDFLERLKVIMQKKYYRH------"),("gi|42627877|ref|NP_958427.1| interleukin-4 precursor [Rattus norvegicus]","MG-LSPHLAVTLFCFLICTGNGIHGCN-DSPLREIINTL--NQVTEKGTPCTEMFVPDVLTATRNTTENELICRASRVLRKFYFPRDVPP-CLKNKSGVL-------GELRKLCRGVSGLNSLR------SCTVNESTLTTLKDFLESLKSILRGKYLQSCTSMS-"),("gi|58743333|ref|NP_001008993.1| interleukin-4 isoform delta2 [Pan troglodytes]","MG-LTSQLLPPLFFLLACAGNFVHGHKCDITLQEIIKTL--NSLTEQ----------------KNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAGLN------SCPVKEANQSTLENFLERLKTIMREKYSKCSS----"),("gi|112807223|ref|NP_001036804.1| interleukin-4 precursor [Felis catus]","MD-LTSQLIPALVCLLAFTSTFVHGQNFNNTLKEIIKTL--NILTARNDSCMELTVMDVLAAPKNTSDKEIFCRATTVLRQIYTHHN----CST-------------KFLKGLDRNLSSMANR-------TCSVNEVKKCTLKDFLERLKAIMQKKYSKH------"),("2B8U:A|PDBID|CHAIN|SEQUENCE|HOMO SAPIENS","-------------------------HKCDITLQEIIKTL--NSLTEQKTLCTELTVTDIFAASKNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAGLN------SCPVKEANQSTLENFLERLKTIMREKYSKCSS----")}

@test mafft_nwnsi(Pkg.dir("BiomolecularStructures","examples/fasta","il4.fasta")) == mafft_nwnsi_expected

mafft_nwns_expected = {("gi|166158130|ref|NP_001107279.1| interleukin 4 [Xenopus (Silurana) tropicalis]","MSNLGRILCAVLGLFHLLSANPVPS--------SKLQIAIEEIISELVNNKITHK-----KCFVPTPYDDEEEASVEEISCRAFKSLKHV---------CASER-----------KNLRLLNASLITMFSENVECSINNDEQKDLISVIEDLLTFFRAQMRKLVMNPKH--------"),("gi|55742622|ref|NP_999288.1| interleukin-4 precursor [Sus scrofa]","-MGLTSQLIPTLVCLLACTSNFVHG--------HKCDITLQEIIKTL--NILTARKNSCMELPVTDVFAAPENTTEKETFCRASTVLRHIYRHHT----CMK-------------SLLSGLDRNLSSMANM--TCSVHEAKKSTLKDFLERLKT---------IMKEKYSKC-----"),("gi|55741696|ref|NP_001007080.1| interleukin 4 [Gallus gallus]","---MSSSL-PTLLALLVL----LAGPGAVPTLCLQLSVPLMESIRIV--NDIQGE-VSCVKMNVTDIFADNKTNNKTELLCKASTIVWE--SQH-----CHK-------NLQGLFLNMRQL-LNASSTSLKA-PCPTAAGNTTSMEKFLADLRTFFH-----QLAKNK---------"),("gi|50978886|ref|NP_001003159.1| interleukin-4 precursor [Canis lupus familiaris]","-MGLTSQLIPTLVCLLALTSTFVHG--------HNFNITIKEIIKML--NILTARNDSCMELTVKDVFTAPKNTSDKEIFCRAATVLRQIYT-HN----CSN-------------RYLRGLYRNLSSMANK--TCSMNEIKKSTLKDFLERLKV---------IMQKKYYRH-----"),("gi|42627877|ref|NP_958427.1| interleukin-4 precursor [Rattus norvegicus]","-MGLSPHLAVTLFCFLICTGNGIHG--------CN-DSPLREIINTL--NQVTEKGTPCTEMFVPDVLTATRNTTENELICRASRVLRKFYFPRDVPP-CLK-------NKSGVLGELRKLCRGVSGLNSLR-SCTVNESTLTTLKDFLESLKS---------ILRGKYLQSCTSMS"),("gi|58743333|ref|NP_001008993.1| interleukin-4 isoform delta2 [Pan troglodytes]","-MGLTSQLLPPLFFLLACAGNFVHG--------HKCDITLQEIIKTL--NSLTEQ----------------KNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAGLN-SCPVKEANQSTLENFLERLKT---------IMREKYSKCSS---"),("gi|112807223|ref|NP_001036804.1| interleukin-4 precursor [Felis catus]","-MDLTSQLIPALVCLLAFTSTFVHG--------QNFNNTLKEIIKTL--NILTARNDSCMELTVMDVLAAPKNTSDKEIFCRATTVLRQIYTHHN----CST-------------KFLKGLDRNLSSMANR--TCSVNEVKKCTLKDFLERLKA---------IMQKKYSKH-----"),("2B8U:A|PDBID|CHAIN|SEQUENCE|HOMO SAPIENS","---------------------------------HKCDITLQEIIKTL--NSLTEQKTLCTELTVTDIFAASKNTTEKETFCRAATVLRQFYSHHEKDTRCLGATAQQFHRHKQLIRFLKRLDRNLWGLAGLN-SCPVKEANQSTLENFLERLKT---------IMREKYSKCSS---")}

@test mafft_nwns(Pkg.dir("BiomolecularStructures","examples/fasta","il4.fasta")) == mafft_nwns_expected


@test alignment_length(mafft_expected_from_string) == 150