using Distributions
using Base.Test

limit =[
      .5  .5  .8;
    -2.5  .5  .8;
     1.5  .5  .8;
      .5  .5  .8;
      .5  .5  .8;
    -1.5  .5  .8;
     1.5  .5  .8;
     -.5 1.  1.2;
     1.  1.  2.;
     1.  2.  1.;
    -2. -2. -2.;
     1.  2.  3.;
    -1.  2.  3.;
     1.  1.  3.;
     1.  1.  3.;
     1.  1.  3.;
     1.  2.  3.;
     1.  2.  3.;
     1. -1. 1.;
     1. -1. 2.
]'

sigma = [
    .1   .6   .8;
    .1  -.6  -.8;
    .1   .6   .8;
    .1  -.6  -.8;
    .1  -.5   .5;
    .1  -.5   .5;
    .1   .5  -.5;
   -.4   .2   .7;
    .4   .8   .8;
    .4   .8   .8;
    .4   .8   .8;
   -.998 -0.248  0.248;
    .25   0.25   0.25;
    .998  0.2482 0.2487;
    .998  0.5    0.5;
    .99   0.99   0.99;
  -1.0   -0.99   0.99;
   1.0   -0.99  -0.99;
    .998 -0.2482 -0.2482;
    .99992 0.64627 0.63975
]'

@assert(size(limit,2) == size(sigma,2))
for nu in 0:3:12
    for j = 1:size(limit,2)
        v = Distributions.tvtcdf(nu, limit[:,j], sigma[:,j])
        #println(nu, limit[:,j], sigma[:,j], v)
        @test v > 0.0
    end
end
