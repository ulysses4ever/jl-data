
function get_mass_from_symbol(symb)
    return masses[symb]
end

function get_mass_from_name(name)
    return masses[symbols[name]]
end
function get_mass_of_compound(formula)
     i=start(search(formula, r"[A-Z]",2))
     i!=0 ? handle_subscripts(formula[1:i-1]) + get_mass_of_compound(formula[i:end])  : handle_subscripts(formula)
end
function handle_subscripts(s)
    i=start(search(s,r"[0-9]"))
    i!=0 ? int(s[i:end])*get_mass_from_symbol(s[1:i-1]) : get_mass_from_symbol(s)
end
n_a = 6.02214129e23
c = 299792458
h = 6.62606957e-34
prefix = [ "Meth" => 1, "Eth" => 2, "Prop" => 3,
           "But" => 4, "Pent" => 5, "Hex" => 6,
           "Hept" => 7, "Oct" => 8, "Non" => 9,
           "Dec" => 10, "Undec" => 11, "Dodec" => 12,
           "Tridec" => 13, "Tetradec" => 14, "Hexadec" => 16,
           "Heptadec" => 17, "Octadec" => 18, "Eicos" => 20,
           "Docos" => 22, "Tetracos" => 24, "Hexacos" => 26,
           "Octacos" => 28, "Triacont" => 30, "Dotriacont" => 32,
           "Tritriacont" => 33, "Tetratriacont" => 34, "Pentatriacont" => 35,
           "Tetracont" => 40 ]

masses = [ "H" =>  1.0082, "He" =>  4.002602, "Li" =>  6.942, "Be" =>  9.012182,
           "B" => 10.812, "C" => 12.0112, "N" => 14.0072, "O" => 15.9992,
           "F" => 18.9984032, "Ne" =>  20.1797, "Na" =>  22.98976928, "Mg" =>  24.3059,
           "Al" =>  26.9815386, "Si" =>  28.0854, "P" => 30.973762, "S" => 32.062,
           "Cl" =>  35.452, "Ar" =>  39.948, "K" => 39.0983, "Ca" =>  40.078,
           "Sc" =>  44.955912, "Ti" =>  47.867, "V" => 50.9415, "Cr" =>  51.9961,
           "Mn" =>  54.938045, "Fe" =>  55.845, "Co" =>  58.933195, "Ni" =>  58.6934,
           "Cu" =>  63.546, "Zn" =>  65.38, "Ga" =>  69.723, "Ge" =>  72.630,
           "As" =>  74.92160, "Se" =>  78.96, "Br" =>  79.9049, "Kr" =>  83.798,
           "Rb" =>  85.4678, "Sr" =>  87.62, "Y" => 88.90585, "Zr" =>  91.224,
           "Nb" =>  92.90638, "Mo" =>  95.96, "Tc" =>  98, "Ru" =>  101.07,
           "Rh" =>  102.90550, "Pd" =>  106.42, "Ag" =>  107.8682, "Cd" =>  112.411,
           "In" =>  114.818, "Sn" =>  118.710, "Sb" =>  121.760, "Te" =>  127.60,
           "I" => 126.90447, "Xe" =>  131.293, "Cs" =>  132.9054519, "Ba" =>  137.327,
           "La" =>  138.90547, "Ce" =>  140.116, "Pr" =>  140.90765, "Nd" =>  144.242,
           "Pm" =>  145, "Sm" =>  150.36, "Eu" =>  151.964, "Gd" =>  157.25,
           "Tb" =>  158.92535, "Dy" =>  162.500, "Ho" =>  164.93032, "Er" =>  167.259,
           "Tm" =>  168.93421, "Yb" =>  173.054, "Lu" =>  174.9668, "Hf" =>  178.49,
           "Ta" =>  180.94788, "W" => 183.84, "Re" =>  186.207, "Os" =>  190.23,
           "Ir" =>  192.217, "Pt" =>  195.084, "Au" =>  196.966569, "Hg" =>  200.592,
           "Tl" =>  204.389, "Pb" =>  207.2, "Bi" =>  208.98040, "Po" =>  209,
           "At " =>  210, "Rn" =>  222, "Fr" =>  223, "Ra" =>  226, "Ac" =>  227 ,
           "Th" =>  232.03806, "Pa" =>  231.03588, "U" => 238.02891, "Np" =>  237,
           "Pu" =>  244, "Am" =>  243, "Cm" =>  247, "Bk" =>  247, "Cf" =>  251,
           "Es" =>  252, "Fm" =>  257, "Md" =>  258, "No" =>  259, "Lr" =>  266,
           "Rf" =>  267, "Db" =>  268, "Sg" =>  269, "Bh" =>  270, "Hs" =>  269,
           "Mt" =>  278, "Ds" =>  281, "Rg" =>  281, "Cn" =>  285, "Uut" =>  286,
           "Fl" =>  289, "Uup" =>  289, "Lv" =>  293, "Uus" =>  294, "Uuo" =>  294, "" => 0]

names = [  "H" => "Hydrogen", "He" => "Helium", "Li" => "Lithium", "Be" => "Beryllium",
           "B" => "Boron", "C" => "Carbon", "N" => "Nitrogen", "O" => "Oxygen",
           "F" => "Fluorine", "Ne" => "Neon", "Na" => "Sodium", "Mg" => "Magnesium",
           "Al" => "Aluminium", "Si" => "Silicon", "P" => "Phosphorus", "S" => "Sulfur",
           "Cl" => "Chlorine", "Ar" => "Argon", "K" => "Potassium", "Ca" => "Calcium",
           "Sc" => "Scandium", "Ti" => "Titanium", "V" => "Vanadium", "Cr" => "Chromium",
           "Mn" => "Manganese", "Fe" => "Iron", "Co" => "Cobalt", "Ni" => "Nickel",
           "Cu" => "Copper", "Zn" => "Zinc", "Ga" => "Gallium", "Ge" => "Germanium",
           "As" => "Arsenic", "Se" => "Selenium", "Br" => "Bromine", "Kr" => "Krypton",
           "Rb" => "Rubidium", "Sr" => "Strontium", "Y" => "Yttrium", "Zr" => "Zirconium",
           "Nb" => "Niobium", "Mo" => "Molybdenum", "Tc" => "Technetium", "Ru" => "Ruthenium",
           "Rh" => "Rhodium", "Pd" => "Palladium", "Ag" => "Silver", "Cd" => "Cadmium",
           "In" => "Indium", "Sn" => "Tin", "Sb" => "Antimony", "Te" => "Tellurium",
           "I" => "Iodine", "Xe" => "Xenon", "Cs" => "Caesium", "Ba" => "Barium",
           "La" => "Lanthanum", "Ce" => "Cerium", "Pr" => "Praseodymium", "Nd" => "Neodymium",
           "Pm" => "Promethium", "Sm" => "Samarium", "Eu" => "Europium", "Gd" => "Gadolinium",
           "Tb" => "Terbium", "Dy" => "Dysprosium", "Ho" => "Holmium", "Er" => "Erbium",
           "Tm" => "Thulium", "Yb" => "Ytterbium", "Lu" => "Lutetium", "Hf" => "Hafnium",
           "Ta" => "Tantalum", "W" => "Tungsten", "Re" => "Rhenium", "Os" => "Osmium",
           "Ir" => "Iridium", "Pt" => "Platinum", "Au" => "Gold", "Hg" => "Mercury",
           "Tl" => "Thallium", "Pb" => "Lead", "Bi" => "Bismuth", "Po" => "Polonium",
           "At" => "Astatine", "Rn" => "Radon", "Fr" => "Francium", "Ra" => "Radium",
           "Ac" => "Actinium", "Th" => "Thorium", "Pa" => "Protactinium", "U" => "Uranium",
           "Np" => "Neptunium", "Pu" => "Plutonium", "Am" => "Americium", "Cm" => "Curium",
           "Bk" => "Berkelium", "Cf" => "Californium", "Es" => "Einsteinium", "Fm" => "Fermium",
           "Md" => "Mendelevium", "No" => "Nobelium", "Lr" => "Lawrencium", "Rf" => "Rutherfordium",
           "Db" => "Dubnium", "Sg" => "Seaborgium", "Bh" => "Bohrium", "Hs" => "Hassium",
           "Mt" => "Meitnerium", "Ds" => "Darmstadtium", "Rg" => "Roentgenium", "Cn" => "Copernicium",
           "Uut" => "Ununtrium", "Fl" => "Flerovium", "Uup" => "Ununpentium", "Lv" => "Livermorium",
           "Uus" => "Ununseptium", "Uuo" => "Ununoctium" ]

symbols = ["Palladium" => "Pd",  "Flerovium" => "Fl",  "Silicon" => "Si",  "Carbon" => "C",
           "Phosphorus" => "P",  "Niobium" => "Nb",  "Silver" => "Ag",  "Gadolinium" => "Gd",
           "Ruthenium" => "Ru",  "Astatine" => "At",  "Ununseptium" => "Uus",  "Antimony" => "Sb",
           "Caesium" => "Cs",  "Copernicium" => "Cn",  "Ununtrium" => "Uut",
           "Beryllium" =>  "Be",  "Strontium" => "Sr",  "Actinium" => "Ac",
           "Californium" => "Cf",  "Tantalum" => "Ta",
           "Gallium" => "Ga",  "Tellurium" => "Te",  "Bohrium" => "Bh",
           "Yttrium" =>  "Y",  "Neptunium" => "Np",  "Uranium" => "U",
           "Plutonium" => "Pu", "Krypton" => "Kr",  "Lawrencium" => "Lr",  "Seaborgium" => "Sg",
           "Calcium" => "Ca",  "Potassium" =>  "K",  "Gold" => "Au",  "Radon" => "Rn",
           "Radium" => "Ra",  "Cerium" =>  "Ce",  "Ununoctium" => "Uuo",
           "Vanadium" => "V",  "Francium" => "Fr",  "Molybdenum" => "Mo",
           "Praseodymium" => "Pr",  "Thorium" => "Th",  "Bromine" => "Br",
           "Zinc" => "Zn",  "Helium" => "He",  "Scandium" => " Sc",  "Hydrogen" => "H",
           "Aluminium" => "Al",  "Sulfur" => "S", "Ununpentium" => "Uup",  "Argon" => "Ar",
           "Germanium" => "Ge", "Erbium" => "Er",  "Iron" => "Fe",  "Magnesium" => "Mg",
           "Fluorine" => "F",  "Lanthanum" => "La",  "Rutherfordium" => "Rf",
           "Tungsten" => "W",  "Lithium" => "Li",  "Dysprosium" => "Dy",
           "Oxygen" => "O",  "Boron" => "B",  "Manganese" => "Mn",  "Bismuth" =>  "Bi",
           "Rhenium" => "Re",  "Dubnium" => "Db",  "Hafnium" => "Hf",
           "Curium" => "Cm",  "Chlorine" => "Cl",  "Indium" => "In",  "Darmstadtium" => "Ds",
           "Rubidium" => "Rb",  "Polonium" => "Po",  "Livermorium" => "Lv",  "Selenium" => "Se",
           "Protactinium" => "Pa",  "Americium" => "Am",  "Barium" => "Ba",  "Rhodium" => "Rh",
           "Titanium" => "Ti",  "Neodymium" => "Nd",  "Promethium" => "Pm",  "Zirconium" => "Zr",
           "Terbium" => "Tb",  "Hassium" => "Hs",  "Samarium" => "Sm",  "Chromium" => "Cr",
           "Copper" => "Cu",  "Technetium" => "Tc",  "Thallium" => "Tl",  "Fermium" => "Fm",
           "Neon" => "Ne",  "Mercury" => "Hg",  "Meitnerium" => "Mt",  "Nitrogen" => "N",
           "Einsteinium" => "Es",  "Ytterbium" => "Yb",  "Lutetium" => "Lu",  "Europium" => "Eu",
           "Sodium" => "Na",  "Osmium" => "Os",  "Nobelium" => "No",  "Nickel" => "Ni",
           "Holmium" => "Ho",  "Cobalt" => "Co",  "Platinum" => "Pt",  "Iridium" => "Ir",
           "Mendelevium" => "Md",  "Xenon" => "Xe",  "Arsenic" =>  "As",  "Tin" => "Sn",
           "Thulium" => "Tm",  "Iodine" => "I",  "Cadmium" => "Cd",  "Lead" => "Pb",
           "Roentgenium" => "Rg",  "Berkelium" => "Bk"] 
